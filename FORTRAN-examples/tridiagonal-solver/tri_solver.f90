program tri_solve
!=========================================================================!
! Preamble                                                                !
!=========================================================================!
use precision_m
implicit none
integer, parameter                  :: M = 25
real(WP), dimension(0:M)            :: b, d
real(WP), dimension(1:M)            :: a
real(WP), dimension(0:M-1)          :: c
integer                             :: i
!=========================================================================!
! A values                                                                !
!=========================================================================!
a   = (/ &
    2.184240786857214_WP,   &
   0.809881106272956_WP,    &
   0.716342804277267_WP,    &
  -1.005571134463613_WP,    &
   0.433986613232231_WP,    &
   0.520143592624929_WP,    &
  -1.092244517341640_WP,    &
  -0.225794451802544_WP,    &
  -0.404921776549187_WP,    &
   0.527859215419956_WP,    &
  -1.006962864115180_WP,    &
   1.089026770604340_WP,    &
   1.784874711621386_WP,    &
  -0.303754520119611_WP,    &
  -0.008696631493738_WP,    &
   0.506635026535164_WP,    &
   1.203251988685244_WP,    &
   0.522017729698728_WP,    &
   0.397046092297073_WP,    &
  -0.482810840319050_WP,    &
  -0.231497194486117_WP,    &
   0.613385212333465_WP,    &
   1.682850536332053_WP,    &
   0.568393573839513_WP,    &
  -1.206029254248903_WP/)

b   = (/ &
    0.433060388963240_WP,&
  -0.092120748499750_WP, &
  -0.244054937965400_WP, &
  -0.219188663046641_WP, &
  -0.879766716388638_WP, &
  -0.320804325089082_WP, &
  -0.784415293755632_WP, &
  -0.364962527939069_WP, &
   0.117270572393548_WP, &
   0.174339688771479_WP, &
  -0.215656413043175_WP, &
  -0.152611479624619_WP, &
   0.033688219863536_WP, &
   0.458282205499795_WP, &
   1.281631220880800_WP, &
   0.620090051558262_WP, &
  -0.286673862460466_WP, &
   0.598015714251220_WP, &
  -0.245532675353110_WP, &
  -1.780737175127046_WP, &
  -2.347239228944969_WP, &
  -1.713595298822377_WP, &
  -0.237127260967104_WP, &
  -0.619625814831921_WP, &
  -0.720160379657291_WP, &
   0.040657173632182_WP /)

c   = (/        &
  -0.658981428583564_WP,    &
  -0.630515032828478_WP,    &
   0.609625091181260_WP,    &
   0.782334970498853_WP,    &
   2.436584358075801_WP,    &
   0.302407416537707_WP,    &
   0.058319853888638_WP,    &
  -0.574133962393711_WP,    &
  -0.195212401051107_WP,    &
  -0.050531277525559_WP,    &
  -1.755775040728589_WP,    &
  -0.257357623581956_WP,    &
   0.749541885371127_WP,    &
  -0.570764308999752_WP,    &
   0.494233375953117_WP,    &
   0.991440438825251_WP,    &
   1.077140113434178_WP,    &
   0.776841798206994_WP,    &
  -2.259840351530994_WP,    &
  -0.564376691130426_WP,    &
   0.901491435092922_WP,    &
   0.394675531568292_WP,    &
   0.004854423718912_WP,    &
   0.436918628028167_WP,    &
   1.130072719996670_WP /)
d   = (/    &
   0.153770741090754_WP,    &
  -0.758627156743334_WP,    &
  -0.180163097123277_WP,    &
  -0.207789586107980_WP,    &
   0.896745287933842_WP,    &
   0.412307702040531_WP,    &
   0.547519687229463_WP,    &
   0.147835043548960_WP,    &
  -0.362267155363552_WP,    &
   0.061141295020601_WP,    &
   0.216705550520381_WP,    &
  -1.398122413117753_WP,    &
   0.178870372986261_WP,    &
   0.927584218205604_WP,    &
  -0.110177935709060_WP,    &
   1.572397878773003_WP,    &
   0.560490613996136_WP,    &
  -0.420344605627486_WP,    &
  -0.153945389665797_WP,    &
  -0.275198593421559_WP,    &
   0.241120454779083_WP,    &
   0.754686393744638_WP,    &
  -0.291909899784922_WP,    &
   0.458445379977200_WP,    &
   1.755288631744442_WP,    &
   0.931490591541562_WP /)
!=========================================================================!
! Elimination                                                             !
!=========================================================================!
do i = 1, M
    b(i)    = b(i) - c(i-1)*a(i)/b(i-1)
    d(i)    = d(i) - d(i-1)*a(i)/b(i-1)
end do
!=========================================================================!
! Back substitution                                                       !
!=========================================================================!
d(M)    = d(M)/b(M)
do i = M-1, 0, -1
    d(i)    = (d(i)-c(i)*d(i+1))/b(i)
end do

do i = 0, M
    print '(f15.9)', d(i)
end do 

end program tri_solve

